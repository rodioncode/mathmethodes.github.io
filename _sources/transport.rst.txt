
Транспортная задача
=========================================================================================

.. toctree::
   :maxdepth: 2


Постановка транспортной задачи. Транспортная таблица
----------------------------------------------------

Транспортная задача - это математическая задача линейного
программирования специального вида о поиске оптимального распределения
однородных объектов с минимизацией затрат на перемещение.

Имеется :math:`{m}` поставщиков :math:`A_1`, :math:`A_2`, ...,
:math:`A_m`, у которых сосредоточены запасы одного и того же груза в
количестве :math:`a_1`, :math:`a_2`, ..., :math:`a_m` единиц,
соответственно. Этот груз нужно доставить :math:`{n}` потребителям
:math:`B_1`, :math:`B_2`, ..., :math:`B_n`, заказавшим :math:`b_1`,
:math:`b_2`, ..., :math:`b_n` единиц этого груза, соответственно.
Известны также все тарифы перевозок груза :math:`c_{ij}` (стоимость
перевозок единицы груза) от поставщика :math:`A_i` к потребителю
:math:`B_j`. Требуется составить такой план перевозок, при котором общая
стоимость всех перевозок была бы минимальной.

Условие транспортной задачи удобно записать в виде следующей
Транспортной таблицы 1.1.

*Транспортная таблица 1*

.. figure::  pictures/Screenshot_4.png
   :align:   center

Обозначим суммарный запас груза у всех поставщиков символом a, а
суммарную потребность в грузе у всех потребителей – символом b.

Тогда

| a=\ :math:`{ \sum_{i=1}^m a_i}`, :math:`{\qquad}`
  b=\ :math:`{ \sum_{j=1}^n b_j}`.


:math:`{\qquad}`\ 1) Транспортная задача называется закрытой,если
a=b.Еслиже :math:`a \neq b`, то транспортная задача называется открытой.

Далее будет показано, что в случае закрытой задачи от поставщиков будут
вывезены все запасы груза, и все заявки потребителей будут удовле-
творены.

В случае открытой задачи при a<b весь груз будет вывезен, однако будут
недопоставки груза экономически невыгодным потребителям. При a>b ,
наоборот, будут удовлетворены все потребители, но часть груза останется
на складах экономически невыгодных поставщиков.

| :math:`{\qquad}`\ 2) Пусть :math:`x_{ij}` (:math:`x_{ij} \geq` 0) –
  количество груза, отправляемого поставщи- ком :math:`A_i` потребителю
  :math:`B_j`. Тогда суммарные затраты Z на перевозки будут вычисляться
  по формуле

| Z=\ :math:`{ \sum_{i=1}^m \sum_{j=1}^n c_{ij}x_{ij}}`.

:math:`{\qquad}`\ 3) Матрица X с неотрицательными элементами
:math:`x_{ij}` называется планом перевозок.

:math:`{\qquad}`\ 4) Функция Z называется целевой функцией.

Математическая формулировка транспортной задачи заключается в нахождении
плана перевозок X =\ :math:`x_{ij}`, который удовлетворяет системе
ограничений

.. math::

   \begin{cases}
               { \sum_{j=1}^n x_{ij}=a_i}, i=1,2,...,m,\\
               { \sum_{i=1}^m x_{ij}=b_j}, j=1,2,...,n,\\
           \end{cases}

 и доставляет минимум целевой функции Z.

:math:`{\qquad}`\ 5) План перевозок, реализующий минимум целевой функции
Z, называется оптимальным.

Смысл первой группы равенств в системе ограничений (см. п.4) состоит в
том, что суммарное количество груза, отправленное всем потребителям каж-
дым поставщиком, равно запасу груза у этого поставщика. Вторая группа
ра- венств в системе ограничений (см. п.4) показывает, что суммарное
количество груза, полученное каждым потребителем от всех поставщиков,
равно заказу этого потребителя.

Сведение открытой транспортной задачи к закрытой
------------------------------------------------

Решение транспортной задачи начинается с выяснения вопроса о том,
является ли задача открытой или закрытой.

Если задача является открытой, то необходимо провести процедуру закрытия
задачи. С этой целью при a<b добавляем фиктивного поставщика
:math:`A'_{m+1}` с запасом груза :math:`a'_{m+1}=b-a`. Если же a>b, то
добавляем фиктивного потребителя :math:`B'_{n+1}` с заказом груза
:math:`b'_{n+1}=a-b`.

В обоих случаях соответствующие фиктивным объектам тарифы перевозок
:math:`c'_{ij}` полагаем равными нулю. В результате суммарная стоимость
перевозок Z не изменяется.

Первоначальный план перевозок
-----------------------------

Транспортная задача относится к задачам линейного программирования, и ее
можно было бы решить симплекс-методом. Но поскольку система огра-
ничений транспортной задачи проще, чем система ограничений ОЗЛП, то это
дает возможность вместо использования объемных симплекс-таблиц применить
более удобный метод, который состоит из следующих этапов:

:math:`{\qquad}`\ 1. Составление первоначального плана перевозок.

:math:`{\qquad}`\ 2. Последовательные улучшения плана перевозок
(перераспределение поставок) до тех пор, пока план перевозок не станет
оптимальным.

Решение ОЗЛП начинается с нахождения опорного плана. Для транспортной
задачи такой план всегда существует. Опишем два метода составле- ния
опорного плана (первоначального плана перевозок). При этом
ненулевыеэлементы :math:`x_{ij}` плана перевозок будем записывать в
соответствующие пустые клетки транспортной таблицы с исходными данными
задачи, а символом (i, j) будем обозначать клетку таблицы, содержащую
информацию о перевозках груза от поставщика :math:`A_i` к потребителю
:math:`B_j`.

Составление первоначального плана перевозок с помощью метода северо-западного угла
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Составление первоначального плана перевозок начнем с перевозки запасов
поставщика :math:`A_1`. Будем за счет его запасов максимально возможно
удовлетворять заказы сначала потребителя :math:`B_1`, затем :math:`B_2`
и так далее. Таким образом, мы будем заполнять таблицу, начиная с клетки
(1,1), и двигаться вправо по строке до тех пор, пока остаток запасов
поставщика :math:`A_1` не окажется меньше заказа очередного потребителя.
Для выполнения этого заказа используем остатки запаса первого
поставщика, а недостающую часть добавим из запасов поставщика
:math:`A_2`, то есть переместимся на следующую строку таблицы по
столбцу, соответствующему указанному потребителю. Далее аналогичным
образом распределим запасы поставщика :math:`A_2`, затем :math:`A_3` и
так далее.

Проиллюстрируем это на следующем примере (Таблица 2).

| *Транспортная таблица 2*

.. figure::  pictures/6.png
   :align:   center

Распределяя запасы поставщика :math:`A_1` сначала потребителю
:math:`B_1`, а затем :math:`B_2`, получаем: :math:`x_{11}`\ =100,
:math:`x_{12}`\ =40. После этого у поставщика :math:`A_1` остается еще
20 единиц груза, а потребителю :math:`B_3` нужно 80 единиц. Удовлетворим
спрос поребителя :math:`B_3`, отправив ему 20 единиц груза, оставшихся у
поставщика :math:`A_1`, 30 единиц груза от поставщика :math:`A_2` и 30
единиц груза от :math:`A_3`. Следовательно,

:math:`x_{13}`\ =20, :math:`x_{23}`\ =30 и :math:`x_{33}`\ =30, 

причем у поставщика :math:`A_3` остается 60 последних единиц груза. Этот
груз и отправим потребителю :math:`B_4`. Таким образом
:math:`x_{34}`\ =60, все запасы груза вывезены и все потребители
удовлетворены.

Теперь мы можем подсчитать общую стоимость всех перевозок по данному
плану:

Z=4\ :math:`\cdot`\ 100+8\ :math:`\cdot`\ 40+10\ :math:`\cdot`\ 20+2\ :math:`\cdot`\ 30+6\ :math:`\cdot`\ 30+5\ :math:`\cdot`\ 60=1460.

Изложенный метод северо-западного угла прост в реализации, однако трудно
надеяться, что он даст экономичный первоначальный план, поскольку при
распределении перевозок мы совершенно не учитывали их стоимость.

Составление первоначального плана перевозок с помощью метода наименьшей стоимости
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Построение плана начнем с клетки с наименьшим тарифом перевозок. При
наличии нескольких клеток с одинаковыми тарифами выберем любую из них.
Пусть это будет клетка (i, j) . Запишем в эту клетку элемент
:math:`x_{ij}`\ =min(\ :math:`a_i`,\ :math:`b_j`). Если
:math:`a_i`\ <:math:`b_j`, то запасы поставщика :math:`A_i` исчерпаны, а
потребителю :math:`B_j` требуется еще :math:`b'_j=b_j-a_i` единиц груза.
Поэтому, не принимая более во внимание i-ю строку, снова ищем клетку с
наименьшей стоимостью перевозок и заполняем ее с учетом изменившихся
потребностей. В случае :math:`a_i`>\ :math:`b_j` из рассмотрения
исключается j-й столбец, а запасы :math:`A_i` полагаются равными
:math:`a'_i=a_i-b_j`. Продолжаем этот процесс до тех пор, пока все
запасы не будут исчерпаны, а все потребности удовлетворены.

Необходимо отметить, что при наличии в таблице клеток с одинаковыми
тарифами, планы, полученные с помощью этого метода, могут быть разными,
однако они, несомненно, ближе к оптимальному плану, чем план,
составленный по методу северо-западного угла.

Сформируем теперь первоначальный план по методу наименьшей стоимости для
рассмотренного в параграфе 2.3.1 примера и сравним результаты (Таблица
3). Поскольку наименьший тариф (число 2) стоит в клетке (2,3), то
запишем в эту клетку элемент :math:`x_{23}`\ =30. Тогда
:math:`b'_3`\ =50, а 2-ю строку таблицы можно больше не учитывать. Среди
оставшихся клеток имеются три клетки с наименьшим тарифом перевозок,
равным 4: (1,1); (3,1) и (3,2). Выберем, например, клетку (1,1) и
запишем в нее число :math:`x_{11}`\ =100. Получаем, что
:math:`a'_1`\ =60, а 1-й столбец таблицы больше не рассматриваем. Теперь
наименьший тариф, равный 4, проставлен в клетке (3,2), поэтому
:math:`x_{32}`\ =40, :math:`b'_3`\ =50 и 2-й столбец больше не нужен.
Далее выбираем клетку (1,4) с тарифом 5 и пишем в нее
:math:`x_{14}`\ =60. Исключив из рассмотрения сразу 1-ю строку и 4-ый
столбец (поскольку :math:`a'_1`\ =\ :math:`b_4`\ = 60), переходим к
последней клетке (3,3), в ко- торую записываем перевозку
:math:`x_{33}`\ =50.

| *Транспортная таблица 3*

.. figure::  pictures/7.png
   :align:   center

Найдем суммарную стоимость перевозок по этому плану:

Z=4\ :math:`\cdot`\ 100+5\ :math:`\cdot`\ 60+2\ :math:`\cdot`\ 30+4\ :math:`\cdot`\ 40+6\ :math:`\cdot`\ 50=1220.

Сравнивая это значение со стоимостью плана, полученного по методу
северо-западного угла, видим, что 1220<1460, то есть мы получили более
выгодный план перевозок.

Вырожденные планы. Циклы и пополнение плана
-------------------------------------------

Прежде, чем перейти к анализу оптимальности планов и способам их
улучшения, выясним, каким требованиям должны удовлетворять составляемые
планы. Для этого вернемся к системе ограничений

.. math::

   \begin{cases}
               { \sum_{j=1}^n x_{ij}=a_i}, i=1,2,...,m,\\
               { \sum_{i=1}^m x_{ij}=b_j}, j=1,2,...,n,\\
           \end{cases}

 В соответствии с определением плана перевозок у матрицы
X=\ :math:`x_{ij}` сумма элементов i-й строки равняется :math:`a_i`,
i=1,2,...,m, а сумма элементов j-о столбца равняется :math:`b_j` ,
j=1,2,...,n. Условие закрытости транспортной задачи a=b означает, что
среди m+n уравнений системы независимыми являются только m+n-1
уравнений, поэтому в любом базисном решении этой системы должно быть
m+n-1 базисных переменных. Поскольку свободные переменные в таком
решении равны нулю, то в транспортной таблице им будут соответствовать
пустые клетки.

-  Клетки таблицы, в которые записаны отличные от нуля перевозки,
   называются базисными, а остальные (пустые) - свободными;

-  План называется вырожденным, если количество базисных клеток в нем
   меньше, чем m+n-1. Если на каком-то этапе решения получился
   вырожденный план, то его необходимо пополнить, проставив в
   недостающем числе клеток нулевую перевозку и превратив, тем самым,
   эти клетки в базисные. Общий баланс и суммарная стоимость перевозок
   плана при этом не изменятся. Однако проводить пополнение плана,
   выбирая клетки произвольно, нельзя. Приведем условия, которым должен
   соответствовать пополненный план.

-  Циклом в транспортной таблице называется несколько клеток,
   соединенных замкнутой ломаной линией так, чтобы две соседние вершины
   ломаной были расположены либо в одной строке, либо в одном столбце.
   Ломаная линия может иметь точки самопересечения, но не в клетках
   цикла.

-  План называется ациклическим, если его базисные клетки не содержат
   циклов. Доказано, что оптимальные планы являются ациклическими,
   поэтому и первоначальный план также должен удовлетворять этому
   требованию. Заметим, что планы, полученные с помощью метода
   северо-западного угла и метода наименьшей стоимости, ациклические.
   Однако если план оказался вырожденным, то при его пополнении
   требование ацикличности необходимо учитывать.

| Возвращаясь к рассматриваемому примеру, видим, что первоначальный
  план, полученный по методу наименьшей стоимости, имеет 5 базисных кле-
  ток, однако m+n-1=3+4-1=6. Значит, план нужно пополнить еще одной
  базисной клеткой. Попробуем выбрать для этого клетку (2,2). Соединив
  базисные клетки горизонтальными и вертикальными отрезками, получаем:

.. figure::  pictures/11.png
   :align:   center

| Видим, что пополненный таким образом план содержит цикл из клеток
  (2,2); (2,3); (3,3) и (3,2), следовательно, клетка (2,2) была выбрана
  неудачно. Взяв вместо нее клетку (2,4), получим ациклический план.
  Поэтому можно заполнить эту клетку, положив :math:`x_{24}`\ =0.

.. figure::  pictures/12.png
   :align:   center

Проверка оптимальности плана и перераспределение поставок с помощью метода потенциалов
--------------------------------------------------------------------------------------

Для анализа полученных планов и их последующего улучшения удобно ввести
дополнительные характеристики пунктов отправления и назначения,
называемые потенциалами.

Вычисление потенциалов
~~~~~~~~~~~~~~~~~~~~~~

Сопоставим каждому поставщику :math:`A_i` и каждому потребителю
:math:`B_j` величины :math:`u_i` и :math:`v_j` соответственно так, чтобы
для всех базисных клеток плана были выполнены соотношения

:math:`u_i`\ +\ :math:`v_j`\ =\ :math:`c_{ij}`, i=1,2,...,m,
j=1,2,...,n.

Поскольку число базисных клеток в плане равно m+n-1 (вырожденные планы
должны быть предварительно пополнены), то для определения потенциалов
получается система из m+n-1 уравнений с m+n неизвестными. Такая система
имеет бесконечное множество решений. Нам требуется любое ее решение.
Обычно для простоты полагают один из потенциалов равным нулю и затем
вычисляют остальные. В транспортной таблице для потенциалов :math:`v_1`,
:math:`v_2`, ..., :math:`v_n` заводится дополнительные строка, а для
потенциалов :math:`u_1`, :math:`u_2`, ..., :math:`u_n` – дополнительный
столбец, куда проставляются найденные значения.

Проверка оптимальности плана
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для каждой свободной клетки плана вычислим разности
:math:`\Delta c_{ij}`\ =\ :math:`c_{ij}`-(:math:`u_i`\ +\ :math:`v_j`) и
запишем полученные значения в левых нижних углах соответствующих клеток.
Заметим, что для базисных клеток выполнено соотношение
:math:`\Delta c_{ij}`\ =0, и этим фактом можно пользоваться для контроля
правильности нахождения потенциалов.

План является оптимальным, если все разности
:math:`\Delta c_{ij} \geq 0`.

В противном случае план можно улучшить следующим способом.

Перераспределение поставок
~~~~~~~~~~~~~~~~~~~~~~~~~~

Найдем клетку с наибольшей по абсолютной величине отрицательной
разностью :math:`\Delta c_{ij}` и построим цикл, в котором кроме этой
клетки все остальные являются базисными. Такой цикл всегда существует и
единственен.

Заметим, что в новом плане суммы элементов по строкам и столбцам должны
остаться прежними, поэтому изменение значения в одной клетке цикла
повлечет за собой соответствующие изменения значений во всех остальных
клетках этого цикла. Так как в свободной клетке значение будет
увеличено, то проставим в ее правом нижнем углу знак :math:`\oplus`.
Теперь пройдем по всей ломаной цикла, проставляя в правых нижних углах
клеток поочередно знаки :math:`\oplus` и :math:`\ominus`.

Груз будет перераспределен по клеткам цикла на величину
:math:`\Delta x`\ =min\ :math:`x_{ij}` следующим образом. В клетках со
знаком «плюс» значение перевозки нужно увеличить на величину
:math:`\Delta x`, а в клетках со знаком «минус» – уменьшить на величину
:math:`\Delta x`. Так как после пересчета у нас добавилась лишняя
базисная клетка, то их количество необходимо сократить, убрав нуль в
одной из клеток цикла. Если таких клеток получилось несколько, то
свободной делаем ту из них, в которой тариф перевозок максимален.

После этого полученный план проверяется на оптимальность описанным выше
способом. Перераспределение груза производится до тех пор, пока
очередной план не станет оптимальным. На этом действие алгоритма
завершается.

Покажем, как нужно пользоваться методом потенциалов, на примере
первоначального плана, полученного выше по методу северо-западного угла.

| Вначале проверим, не является ли этот план вырожденным. Так как
  m+n-1=3+4-1=6, и число базисных клеток в плане также равно 6, то план
  в пополнении не нуждается. Найдем потенциалы по базисным клеткам
  таблицы с помощью формул , положив :math:`u_1`\ =0,

.. math::

   \begin{cases}
              u_1+v_1=4,\\
              u_1+v_2=8,\\
              u_1+v_3=10,\\
              u_2+v_3=2,\\
              u_3+v_3=6,\\
              u_3+v_4=5,\\
              u_1=0,\\
           \end{cases}

 

.. math::

   \begin{cases}
              u_1=0,\\
              u_2=-8,\\
              u_3=-4,\\
              v_1=4,\\
              v_2=8,\\
              v_3=10,\\
              v_4=9,\\
           \end{cases}

| 
| и занесем полученные значения в таблицу. Вычислим теперь разности
  :math:`\Delta c_{ij}` для свободных клеток и также проставим эти
  данные в левых нижних углах соответствующих клеток. В итоге получим
  следующую Tаблицу 4.

| *Транспортная таблица 4*

.. figure::  pictures/8.png
   :align:   center

Поскольку :math:`\Delta c_{14}`\ =-4<0, то этот план не является
оптимальным. Перераспределим груз по циклу, обозначенному в Tаблице 4
пунктиром, на величину :math:`\Delta x`\ = min(20,60)=20. Для этого в
клетках со знаком «плюс» увеличим поставки на 20 единиц, а клетках со
знаком «минус» – поставки на столько же уменьшим. Для сохранения
количества базисных клеток число 0 в клетке (1,3) не записываем, и она
становится свободной.

Вычислив потенциалы и разности :math:`\Delta c_{ij}` для нового плана,
видим, что снова есть отрицательная разность :math:`\Delta c_{32}`\ =-4.
Поэтому придется еще раз улучшать план. С этой целью перераспределим
груз по циклу, отмеченному в таблице 5 пунктиром, на величину
:math:`\Delta x`\ = min(40,40)=40. Так как в результате в цикле
получаются две клетки с нулевыми перевозками: (1,3) и (3,4) , то сделаем
свободной клетку (1,3), поскольку ее тариф перевозок больше. После
перераспределения груза по циклу вычислим все необходимые разности
:math:`\Delta c_{ij}`.

| *Транспортная таблица 5*

.. figure::  pictures/9.png
   :align:   center

Как видим, все :math:`\Delta c_{ij}` неотрицательны, значит, план
оптимален (Tаблица 6).

| *Транспортная таблица 6*

.. figure::  pictures/10.png
   :align:   center

Практическое применение транспортной задачи
-------------------------------------------

Пример решения транспортной задачи
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Пример:** На складах трех поставщиков :math:`A_1`, :math:`A_2`,
:math:`A_3` хранится 300, 250 и 200 единиц одного и того же груза. Этот
груз требуется доставить четырем потребителям :math:`B_1`, :math:`B_2`,
:math:`B_3` и :math:`B_4`, заказы которых составляют 220, 150, 250 и 180
единиц груза соответственно. Стоимости перевозок :math:`c_{ij}` единицы
груза с i-го склада j-му потребителю указаны в правых верхних углах
соответствующих клеток транспортной Таблицы 1.

| *Транспортная таблица 1*

.. figure::  pictures/13.png
   :align:   center

Составить такой план перевозок груза, при котором общая стоимость всех
перевозок была бы минимальной.

**Решение:** Поскольку суммарный запас груза а=300+250+200=750 меньше
суммарной потребности b=220+150+250+180=800, то рассматриваемая
транспортная задача является открытой. Сведем ее к закрытой, добавив
фиктивного поставщика :math:`A'_4` с нулевыми тарифами перевозок и
запасом груза :math:`a'_4`\ =b-a=50. Составим первоначальный план
перевозок с помощью метода наименьшей стоимости, заполняя клетки в
следующем порядке - получаем Таблицу 2:

(4,2) :math:`\rightarrow` (3,2) :math:`\rightarrow` (2,3)
:math:`\rightarrow` (3,4) :math:`\rightarrow` (1,1) :math:`\rightarrow`
(1,4).

| *Транспортная таблица 2*

.. figure::  pictures/14.png
   :align:   center

Перейдем к анализу полученного плана. Заметим, что в этой задаче
m+n-1=4+4-1=7, а число занятых клеток в имеющемся плане равно 6. Значит,
необходимо пополнить план еще 1 клеткой, записав в ней 0, так, чтобы
пополненный план получился ациклическим. Выберем для этой цели,
например, клетку (4,3).

.. math::

   \begin{cases}
              u_1+v_1=4,\\
              u_1+v_4=6,\\
              u_2+v_3=1,\\
              u_3+v_2=1,\\
              u_3+v_4=2,\\
              u_4+v_2=0,\\
              u_4+v_3=0,\\
              u_1=0,\\
           \end{cases}

 

.. math::

   \begin{cases}
              u_1=0,\\
              u_2=-4,\\
              u_3=-4,\\
              u_4=-5,\\
              v_1=4,\\
              v_2=5,\\
              v_3=5,\\
              v_4=6,\\
           \end{cases}

Вычислим потенциалы по базисным клеткам плана и вычислим для свободных
клеток разности

:math:`\Delta c_{ij}`\ =\ :math:`c_{ij}`-(:math:`u_i`\ +\ :math:`v_j`).

Получим таблицу 3.

| *Транспортная таблица 3*

.. figure::  pictures/15.png
   :align:   center

Поскольку среди чисел :math:`\Delta c_{ij}` есть отрицательные, то
перераспределим груз на величину

:math:`\Delta x`\ =min(80,100,0)=0

по циклу, обозначенному пунктиром. Клетка (1,3) станет базисной вместо
клетки (4,3), и мы получим Таблицу 4. План, указанный в Таблице 4, не
является оптимальным, поскольку

:math:`\Delta c_{22}`\ = :math:`\Delta c_{44}`\ =-1<0.

Улучшим этот план с помощью перераспределения поставок по циклу,
обозначенному в Таблице 4 пунктиром, на величину

:math:`\Delta x`\ =min(100,50)=50.

Получим Таблицу 4.

| *Транспортная таблица 4*

.. figure::  pictures/16.png
   :align:   center

В Таблице 5 перераспределение осуществляется по ступенчатому циклу.

| *Транспортная таблица 5*

.. figure::  pictures/17.png
   :align:   center

После еще одного перераспределения поставок на величину
:math:`\Delta x`\ =80 , получим Таблицу 6.

| *Транспортная таблица 6*

.. figure::  pictures/18.png
   :align:   center

Заметим, что после каждого перераспределения груза производились
вычисления потенциалов и разностей :math:`\Delta c_{ij}` для полученного
плана, и эти данные проставлялись в таблицу.

В Таблице 6 все разности :math:`\Delta c_{ij} \geq 0`, следовательно,
план оптимален. Таким образом,

.. math::

   X= 
           \begin{pmatrix}
           220 & 0 & 80 & 0 \\
           0 & 80 & 170 & 0 \\
           0 & 70 & 0 & 130 
           \end{pmatrix}

Фиктивный груз :math:`a'_4`\ =50 в Таблице 6 означает, что потребителю
:math:`B_4` будет недопоставлено 50 единиц груза.

Найдем суммарную стоимость перевозок по оптимальному плану:

:math:`Z_{min}`\ =\ :math:`{ \sum_{i=1}^3 \sum_{j=1}^4 c_{ij}x_{ij}}`\ =4\ :math:`\cdot`\ 220+3\ :math:`\cdot`\ 80+2\ :math:`\cdot`\ 80+1\ :math:`\cdot`\ 170+1\ :math:`\cdot`\ 70+2\ :math:`\cdot`\ 130=1780.


Перейти к практике
-------------------
`Посмотреть примеры и решить задачу <http://en.wikipedia.org/wiki/Hyperlink>`_